{
  "name": "Apricot-alerts",
  "items": [
    {
      "name": "Suricata / Snort Alerts Overview",
      "value": "event_type==\"alert\" | count() by alert.signature | sort -r",
      "description": "Displays a count of Suricata / Snort alerts grouped by signature"
    },
    {
      "name": "Alerts by Severity & Category",
      "value": "event_type==\"alert\" | count() by alert.severity, alert.category | sort -r",
      "description": "Shows alert counts grouped by category and severity"
    },
     {
      "name": "Top Source IPs Triggering Alerts",
      "value": "_path==\"alert\" | count() by src_ip | sort -r",
      "description": "Shows the source IP addresses that triggered the most alerts"
    },
    {
      "name": "Alerts Triggered by Known Malware Signatures",
      "value": "_path==\"alert\" AND alert.signature =~ /(Malware|Trojan|Ransomware)/ | count() by alert.signature | sort -r",
      "description": "Identifies IDS/IPS alerts related to malware or ransomware signatures"
    },
    {
      "name": "Alert Spike Detection",
      "value": "_path==\"alert\" | count() by ts:=floor(ts,1h) | filter count > 50 | sort ts",
      "description": "Detects sudden spikes in alert volume over time"
    },
    {
      "name": "Top Alert Signatures",
      "value": "event_type==\"alert\" | count() by alert.signature | sort -r",
      "description": "Displays the most frequent alert signatures"
    },
    {
      "name": "Alert Signatures by IP Pair",
      "value": "event_type==\"alert\" | put sigs := union(alert.signature) by src_ip, dest_ip | sort -r",
      "description": "Lists alert signatures grouped by source & destination IP"
    },
    {
      "name": "Top Source Ports for Alerts",
      "value": "event_type==\"alert\" | count() by src_port | sort -r",
      "description": "Displays the top source ports for alerts"
    },
    {
      "name": "Top Destination Ports for Alerts",
      "value": "event_type==\"alert\" | count() by dest_port | sort -r",
      "description": "Shows the top destination ports for alerts"
    },
    {
      "name": "Alert Categories by Network Segment",
      "value": "event_type==\"alert\" | put segment := network_of(dest_ip) | alerts := union(alert.category) by segment | sort -r",
      "description": "Shows alert categories grouped by destination network segment"
    },
    {
      "name": "Alerts by Protocol",
      "value": "event_type==\"alert\" | count() by proto | sort -r",
      "description": "Shows alert counts grouped by protocol"
    },
    {
      "name": "Alerts by Classification",
      "value": "event_type==\"alert\" | count() by alert.classification | sort -r",
      "description": "Counts alerts by classification"
    },
    {
      "name": "Alerts Timeline (hourly)",
      "value": "event_type==\"alert\" | count() by ts := floor(ts, 1h) | sort ts",
      "description": "Shows hourly alert counts over time"
    },
    {
      "name": "Alerts by Priority",
      "value": "event_type==\"alert\" | count() by alert.priority | sort -r",
      "description": "Counts alerts by priority"
    },
    {
      "name": "Alerts with Payload",
      "value": "event_type==\"alert\" AND payload != null() | cut ts, src_ip, dest_ip, proto, payload | sort -r ts",
      "description": "Displays alerts that include payload data"
    },
    {
      "name": "Alerts by Sensor",
      "value": "event_type==\"alert\" | count() by sensor | sort -r",
      "description": "Counts alerts by sensor"
    },
    {
      "name": "Alerts by Network Segment (dest)",
      "value": "event_type==\"alert\" | put segment := network_of(dest_ip) | count() by segment | sort -r",
      "description": "Counts alerts per destination network segment"
    },
    {
      "name": "Alerts by Source IP",
      "value": "event_type==\"alert\" | count() by src_ip | sort -r",
      "description": "Shows alerts grouped by source IP"
    },
    {
      "name": "Alerts by Destination IP",
      "value": "event_type==\"alert\" | count() by dest_ip | sort -r",
      "description": "Shows alerts grouped by destination IP"
    },
    {
      "name": "WAF Alerts (Web Application Firewall)",
      "value": "event_type==\"alert\" AND alert.category==\"WAF\" | count() by alert.signature | sort -r",
      "description": "Displays alerts generated by a WAF"
    }
  ]
}
